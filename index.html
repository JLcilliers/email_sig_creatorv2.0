<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FSE Digital Email Signature Generator</title>
  <style>
    :root {
      --bg: #0b0c0f;
      --panel: #151821;
      --ink: #e6e8ec;
      --muted: #9aa3b2;
      --accent: #0066cc;
      --ok: #2ea44f;
      --warn: #a67900;
      --border: #232838;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: linear-gradient(180deg, #0b0c0f, #0f1220 60%, #0b0c0f);
      color: var(--ink);
    }
    header {
      padding: 20px clamp(16px, 3vw, 28px);
      border-bottom: 1px solid var(--border);
      background: rgba(15,18,32,0.85);
      position: sticky;
      top: 0;
      z-index: 10;
      backdrop-filter: blur(10px);
    }
    header h1 {
      margin: 0 0 6px 0;
      font-size: clamp(18px, 3.4vw, 24px);
      letter-spacing: 0.2px;
    }
    header p {
      margin: 0;
      color: var(--muted);
      font-size: 14px;
    }
    main {
      display: grid;
      grid-template-columns: 420px 1fr;
      gap: 18px;
      padding: 18px;
      max-width: 1600px;
      margin: 0 auto;
    }
    @media (max-width: 980px) {
      main { grid-template-columns: 1fr; }
    }
    .card {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    }
    .card h2 {
      margin: 0 0 12px 0;
      font-size: 16px;
      color: #f3f4f6;
      font-weight: 600;
    }
    .row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .field { margin-bottom: 12px; }
    label {
      display: block;
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 6px;
      font-weight: 500;
    }
    input[type="text"], input[type="email"], input[type="url"], input[type="tel"], input[type="color"], textarea {
      width: 100%;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: #0e111a;
      color: var(--ink);
      outline: none;
      font-size: 14px;
      transition: border-color 0.2s;
    }
    input:focus, textarea:focus {
      border-color: var(--accent);
    }
    input[type="file"] {
      width: 100%;
      border: 1px dashed var(--border);
      border-radius: 8px;
      padding: 10px;
      color: var(--muted);
      font-size: 13px;
    }
    input[type="color"] {
      height: 42px;
      cursor: pointer;
    }
    .hint { 
      font-size: 11px; 
      color: var(--muted); 
      margin-top: 4px;
      line-height: 1.4;
    }
    .btns {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 16px;
    }
    button {
      padding: 11px 16px;
      background: var(--accent);
      color: white;
      border: 0;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: all 0.2s;
    }
    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0,102,204,0.3);
    }
    .ghost { 
      background: transparent; 
      border: 1px solid var(--border); 
      color: var(--ink); 
    }
    .ghost:hover {
      background: rgba(255,255,255,0.05);
      box-shadow: none;
    }
    .ok { background: var(--ok); }
    .ok:hover { box-shadow: 0 4px 12px rgba(46,164,79,0.3); }
    .preview-wrap {
      display: grid;
      grid-template-rows: auto auto 1fr;
      gap: 14px;
    }
    .preview-canvas {
      background: #F0EEEB;
      border-radius: 12px;
      border: 1px solid #dfe3ea;
      padding: 20px;
      color: #212529;
      min-height: 300px;
    }
    .code-area {
      width: 100%;
      min-height: 200px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      font-size: 12px;
      line-height: 1.5;
      color: #e6e8ec;
      background: #0e111a;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px;
      resize: vertical;
    }
    .footer-note { 
      font-size: 12px; 
      color: var(--muted); 
      margin-top: 12px;
      line-height: 1.5;
    }
    .divider { 
      height: 1px; 
      background: var(--border); 
      margin: 16px 0; 
    }
    .usage-list {
      font-size: 12px;
      color: var(--muted);
      line-height: 1.6;
      margin: 8px 0;
      padding-left: 20px;
    }
    .usage-list li {
      margin-bottom: 6px;
    }
    .brand-tag {
      display: inline-block;
      background: rgba(0,102,204,0.1);
      color: var(--accent);
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
      margin-top: 8px;
    }
  </style>
</head>
<body>
  <header>
    <h1>üöÄ FSE Digital Email Signature Generator</h1>
    <p>Fill in your details below ‚Ä¢ Preview updates in real-time ‚Ä¢ Copy and paste into your email client</p>
  </header>

  <main>
    <section class="card" id="formCard" aria-label="Signature form">
      <h2>üë§ Your Details</h2>
      <div class="row">
        <div class="field">
          <label for="first">First Name *</label>
          <input id="first" type="text" placeholder="John" required />
        </div>
        <div class="field">
          <label for="last">Last Name *</label>
          <input id="last" type="text" placeholder="Smith" required />
        </div>
      </div>
      
      <div class="field">
        <label for="title">Job Title *</label>
        <input id="title" type="text" placeholder="Senior Digital Marketing Specialist" required />
      </div>

      <div class="row">
        <div class="field">
          <label for="email">Email Address *</label>
          <input id="email" type="email" placeholder="john@fsedigital.com" required />
        </div>
        <div class="field">
          <label for="phone">Mobile Number *</label>
          <input id="phone" type="tel" placeholder="+27 XX XXX XXXX" required />
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label for="website">Website URL</label>
          <input id="website" type="url" placeholder="https://fsedigital.com" value="https://fsedigital.com" />
        </div>
        <div class="field">
          <label for="linkedin">LinkedIn Profile URL</label>
          <input id="linkedin" type="url" placeholder="https://linkedin.com/in/yourprofile" />
        </div>
      </div>

      <div class="divider"></div>
      <h2>üì∏ Profile Photo</h2>
      <div class="field">
        <label for="headshotFile">Upload Photo (Square format recommended)</label>
        <input id="headshotFile" type="file" accept="image/*" />
        <div class="hint">üí° For best compatibility across all email clients, use the URL option below with a hosted image.</div>
      </div>
      <div class="field">
        <label for="headshotUrl">OR paste Photo URL (Recommended)</label>
        <input id="headshotUrl" type="url" placeholder="https://yourdomain.com/photos/john-smith.jpg" />
        <div class="hint">Host your photo on a CDN or cloud storage for maximum compatibility.</div>
      </div>

      <div class="divider"></div>
      <h2>üé® Brand Customization</h2>
      <div class="row">
        <div class="field">
          <label for="brandColor">Primary Link Color</label>
          <input id="brandColor" type="color" value="#FF731B" />
          <div class="hint">Used for links and accent line</div>
        </div>
        <div class="field">
          <label for="textColor">Text Color</label>
          <input id="textColor" type="color" value="#212529" />
        </div>
      </div>

      <div class="btns">
        <button id="btnPreview" type="button" class="ok">üîÑ Refresh Preview</button>
        <button id="btnCopyRich" type="button">üìã Copy Rich Signature</button>
        <button id="btnCopyCode" type="button" class="ghost">üíª Copy HTML Code</button>
        <button id="btnDownload" type="button" class="ghost">‚¨áÔ∏è Download HTML</button>
        <button id="btnReset" type="button" class="ghost">üîÉ Reset Form</button>
      </div>
      
      <div class="brand-tag">üè¢ FSE Digital Branding Locked</div>
      <p class="footer-note">‚úÖ All partner logos and branding are pre-configured. Simply fill in your personal details and copy the signature.</p>
    </section>

    <section class="preview-wrap">
      <div class="card">
        <h2>üëÅÔ∏è Live Preview</h2>
        <div id="preview" class="preview-canvas" aria-live="polite"></div>
      </div>
      
      <div class="card">
        <h2>üìù HTML Code</h2>
        <textarea id="code" class="code-area" spellcheck="false" readonly></textarea>
      </div>
      
      <div class="card">
        <h2>üìñ How to Use</h2>
        <ul class="usage-list">
          <li><strong>Gmail:</strong> Click "Copy Rich Signature" ‚Üí Go to Gmail Settings ‚Üí General ‚Üí Signature ‚Üí Paste</li>
          <li><strong>Outlook Desktop:</strong> Click "Copy Rich Signature" ‚Üí Tools ‚Üí Options ‚Üí Mail Format ‚Üí Signatures ‚Üí Paste</li>
          <li><strong>Outlook Web:</strong> Settings ‚Üí View all Outlook settings ‚Üí Mail ‚Üí Compose and reply ‚Üí Email signature ‚Üí Paste</li>
          <li><strong>Apple Mail:</strong> Preferences ‚Üí Signatures ‚Üí Click "+" ‚Üí Select all default text ‚Üí Paste</li>
          <li><strong>Troubleshooting:</strong> If images don't appear, use hosted URLs instead of uploaded files</li>
        </ul>
      </div>
    </section>
  </main>

  <script>
    // Utility functions
    const esc = (s) => String(s || '').replace(/[&<>"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]));
    const trim = (s) => String(s || '').trim();
    const ensureHttps = (u) => {
      u = trim(u);
      if (!u) return '';
      if (/^https?:\/\//i.test(u)) return u;
      return 'https://' + u.replace(/^\/+/, '');
    };
    const telHref = (p) => {
      const digits = String(p || '').replace(/[^0-9+]/g, '');
      return digits ? 'tel:' + digits : '';
    };

    const fileToDataURL = (file) => new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onload = () => resolve(reader.result);
      reader.onerror = reject;
      reader.readAsDataURL(file);
    });

    // FSE Digital Brand Assets - Locked
    const BRAND_ASSETS = {
      companyLogos: [
        'https://www.fsedigital.com/email-signatures/FreelanceSEOLogo.png',
        'https://www.fsedigital.com/email-signatures/fseDigitalLogo.png'
      ],
      partnerLogos: [
        'https://www.fsedigital.com/email-signatures/MailChimpIcon.png',
        'https://www.fsedigital.com/email-signatures/SEMrushIcons.png',
        'https://www.fsedigital.com/email-signatures/MetBusinessPartners.png',
        'https://www.fsedigital.com/email-signatures/googlepartner.webp',
        'https://www.fsedigital.com/email-signatures/bingPartner.png'
      ],
      phoneIcon: 'https://www.fsedigital.com/email-signatures/PhoneIcon.png',
      emailIcon: 'https://www.fsedigital.com/email-signatures/emailIcon.png',
      websiteIcon: 'https://www.fsedigital.com/email-signatures/DomainIcon.png',
      linkedInIcon: 'https://www.fsedigital.com/email-signatures/LinkedInIcon.png'
    };

    async function getFormValues() {
      const vals = {
        first: trim(document.getElementById('first').value),
        last: trim(document.getElementById('last').value),
        title: trim(document.getElementById('title').value),
        email: trim(document.getElementById('email').value),
        phone: trim(document.getElementById('phone').value),
        website: ensureHttps(document.getElementById('website').value),
        linkedin: ensureHttps(document.getElementById('linkedin').value),
        headshotUrl: ensureHttps(document.getElementById('headshotUrl').value),
        brandColor: document.getElementById('brandColor').value || '#FF731B',
        textColor: document.getElementById('textColor').value || '#212529',
      };

      // Handle file upload
      const fileInput = document.getElementById('headshotFile');
      if (!vals.headshotUrl && fileInput.files && fileInput.files[0]) {
        try {
          vals.headshotUrl = await fileToDataURL(fileInput.files[0]);
        } catch (_) {}
      }
      return vals;
    }

    function buildSignatureHTML(v) {
      const fullName = esc([v.first, v.last].filter(Boolean).join(' '));
      const tColor = v.textColor;
      const linkColor = v.brandColor;

      // Build headshot cell - larger and centered vertically
      const photoCell = v.headshotUrl ? `
        <td style="padding:0 20px 0 0; vertical-align:middle;">
          <img src="${v.headshotUrl}" alt="${fullName}" width="140" height="140" style="display:block; border-radius:50%; border:3px solid ${linkColor}; outline:0; text-decoration:none;" />
        </td>` : '';

      // Build company logos stacked vertically - both left-aligned at natural size
      const companyLogosHTML = `
        <div style="margin:10px 0 0 0;">
          <img src="${BRAND_ASSETS.companyLogos[0]}" alt="Freelance SEO" style="display:block; border:0; outline:0; text-decoration:none; margin:0;" />
          <img src="${BRAND_ASSETS.companyLogos[1]}" alt="FSE Digital" style="display:block; border:0; outline:0; text-decoration:none; margin:6px 0 0 0;" />
        </div>`;

      // Build contact rows with icons
      const contactRows = [];

      // Hardcoded landline number - always shown
      contactRows.push(`
        <tr>
          <td style="padding:4px 8px 4px 0; vertical-align:middle;">
            <img src="${BRAND_ASSETS.phoneIcon}" alt="Phone" width="16" height="16" style="display:block; border:0;" />
          </td>
          <td style="padding:4px 0; font-size:14px; color:#000000;">
            <a href="tel:+441245477449" style="color:#000000; text-decoration:none;">+44 (0)1245 477 449</a>
          </td>
        </tr>`);

      if (v.phone) {
        const pDisp = esc(v.phone);
        const pHref = telHref(v.phone);
        contactRows.push(`
          <tr>
            <td style="padding:4px 8px 4px 0; vertical-align:middle;">
              <img src="${BRAND_ASSETS.phoneIcon}" alt="Phone" width="16" height="16" style="display:block; border:0;" />
            </td>
            <td style="padding:4px 0; font-size:14px; color:#000000;">
              ${pHref ? `<a href="${pHref}" style="color:#000000; text-decoration:none;">${pDisp}</a>` : `<span style="color:#000000;">${pDisp}</span>`}
            </td>
          </tr>`);
      }

      if (v.email) {
        const eDisp = esc(v.email);
        contactRows.push(`
          <tr>
            <td style="padding:4px 8px 4px 0; vertical-align:middle;">
              <img src="${BRAND_ASSETS.emailIcon}" alt="Email" width="16" height="16" style="display:block; border:0;" />
            </td>
            <td style="padding:4px 0; font-size:14px; color:#000000;">
              <a href="mailto:${eDisp}" style="color:#000000; text-decoration:none;">${eDisp}</a>
            </td>
          </tr>`);
      }

      if (v.website) {
        const wDisp = esc(v.website.replace(/^https?:\/\//i, ''));
        contactRows.push(`
          <tr>
            <td style="padding:4px 8px 4px 0; vertical-align:middle;">
              <img src="${BRAND_ASSETS.websiteIcon}" alt="Website" width="16" height="16" style="display:block; border:0;" />
            </td>
            <td style="padding:4px 0; font-size:14px; color:#000000;">
              <a href="${v.website}" style="color:#000000; text-decoration:none;">${wDisp}</a>
            </td>
          </tr>`);
      }

      if (v.linkedin) {
        contactRows.push(`
          <tr>
            <td style="padding:4px 8px 4px 0; vertical-align:middle;">
              <img src="${BRAND_ASSETS.linkedInIcon}" alt="LinkedIn" width="16" height="16" style="display:block; border:0; border-radius:2px;" />
            </td>
            <td style="padding:4px 0; font-size:14px; color:#000000;">
              <a href="${v.linkedin}" style="color:#000000; text-decoration:none;">LinkedIn Profile</a>
            </td>
          </tr>`);
      }

      // Build partner logos row
      const logoSpacing = '<td style="width:10px; font-size:0; line-height:0;">&nbsp;</td>';
      const partnerLogoCells = BRAND_ASSETS.partnerLogos.map(url => `
        <td style="padding:0;">
          <img src="${url}" alt="Partner" height="28" style="display:block; border:0; outline:0; text-decoration:none;" />
        </td>
      `).join(logoSpacing);

      const partnerLogosHTML = `
        <tr>
          <td colspan="2" style="padding:16px 0 0 0;">
            <table role="presentation" cellpadding="0" cellspacing="0" border="0" style="border-collapse:collapse;">
              <tr>${partnerLogoCells}</tr>
            </table>
          </td>
        </tr>`;

      // Build complete signature
      const html = `<!-- FSE Digital Email Signature - ${fullName} -->
<table role="presentation" cellpadding="0" cellspacing="0" border="0" style="border-collapse:collapse; font-family: 'Segoe UI', Arial, Helvetica, sans-serif; background:#ffffff; max-width:600px;">
  <tr>
    <td style="padding:16px; border-top:4px solid ${linkColor};">
      <table role="presentation" cellpadding="0" cellspacing="0" border="0" style="border-collapse:collapse;">
        <tr>
          ${photoCell}
          <td style="padding:0; vertical-align:top;">
            <div style="font-size:20px; line-height:24px; color:${tColor}; font-weight:700; margin:0;">${fullName}</div>
            <div style="font-size:15px; line-height:20px; color:#666666; margin:4px 0 0 0;">${esc(v.title)}</div>
            ${companyLogosHTML}
            <div style="height:12px; font-size:0; line-height:0;">&nbsp;</div>
            <table role="presentation" cellpadding="0" cellspacing="0" border="0" style="border-collapse:collapse;">
              ${contactRows.join('')}
            </table>
          </td>
        </tr>
        ${partnerLogosHTML}
      </table>
    </td>
  </tr>
</table>
<!-- End of FSE Digital Email Signature -->`;

      return html;
    }

    async function render() {
      const v = await getFormValues();
      const html = buildSignatureHTML(v);
      document.getElementById('preview').innerHTML = html;
      document.getElementById('code').value = html;
    }

    async function copyRich() {
      const html = document.getElementById('code').value;
      if (!html) {
        alert('‚ö†Ô∏è Please fill in the required fields first.');
        return;
      }
      
      try {
        if (navigator.clipboard && window.ClipboardItem) {
          const item = new ClipboardItem({
            "text/html": new Blob([html], { type: "text/html" }),
            "text/plain": new Blob([html], { type: "text/plain" })
          });
          await navigator.clipboard.write([item]);
          alert('‚úÖ Rich signature copied! Now paste it into your email signature settings.');
          return;
        }
      } catch (err) {
        console.error('ClipboardItem failed:', err);
      }
      
      // Fallback
      try {
        const range = document.createRange();
        range.selectNodeContents(document.getElementById('preview'));
        const sel = window.getSelection();
        sel.removeAllRanges();
        sel.addRange(range);
        const ok = document.execCommand('copy');
        sel.removeAllRanges();
        if (ok) {
          alert('‚úÖ Copied! Now paste into your email signature settings.');
        } else {
          alert('‚ö†Ô∏è Copy failed. Please select the preview manually and copy with Ctrl+C or Cmd+C.');
        }
      } catch (err) {
        alert('‚ö†Ô∏è Copy not supported. Please select the preview manually and copy with Ctrl+C or Cmd+C.');
      }
    }

    async function copyCode() {
      const ta = document.getElementById('code');
      ta.focus();
      ta.select();
      try {
        document.execCommand('copy');
        alert('‚úÖ HTML code copied to clipboard!');
      } catch (err) {
        alert('‚ö†Ô∏è Copy failed. Please select the code manually.');
      }
    }

    function downloadHTML() {
      const html = document.getElementById('code').value;
      if (!html) {
        alert('‚ö†Ô∏è Please fill in the required fields first.');
        return;
      }
      const blob = new Blob([html], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'fse-digital-signature.html';
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
      alert('‚úÖ Signature downloaded!');
    }

    function resetForm() {
      const inputs = document.querySelectorAll('#formCard input[type="text"], #formCard input[type="email"], #formCard input[type="tel"], #formCard input[type="url"]');
      inputs.forEach(el => {
        if (el.id !== 'website') el.value = '';
      });
      document.getElementById('website').value = 'https://fsedigital.com';
      document.getElementById('brandColor').value = '#FF731B';
      document.getElementById('textColor').value = '#212529';
      document.getElementById('headshotFile').value = '';
      render();
    }

    // Event listeners
    document.getElementById('btnPreview').addEventListener('click', render);
    document.getElementById('btnCopyRich').addEventListener('click', copyRich);
    document.getElementById('btnCopyCode').addEventListener('click', copyCode);
    document.getElementById('btnDownload').addEventListener('click', downloadHTML);
    document.getElementById('btnReset').addEventListener('click', resetForm);

    // Auto-update preview on input
    document.querySelectorAll('input, textarea').forEach(el => {
      el.addEventListener('input', () => {
        window.clearTimeout(window._sigTimer);
        window._sigTimer = setTimeout(render, 150);
      });
    });

    // Demo data for testing
    function fillDemo() {
      document.getElementById('first').value = 'John';
      document.getElementById('last').value = 'Smith';
      document.getElementById('title').value = 'Senior Digital Marketing Specialist';
      document.getElementById('email').value = 'john.smith@fsedigital.com';
      document.getElementById('phone').value = '+27 82 123 4567';
      document.getElementById('website').value = 'https://fsedigital.com';
      document.getElementById('linkedin').value = 'https://linkedin.com/in/johnsmith';
    }

    // Initialize
    fillDemo();
    render();
  </script>
</body>
</html>
